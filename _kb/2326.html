---
title: "Containers will not start on ucp-hrm network"
id: 2326
draftstate: inactive
deleted: false
layout: docs
permalink: /kb/2326/
originalpath: https://success.docker.com/KBase/Containers_will_not_start_on_ucp-hrm_network
source: https://success.docker.com/@api/deki/pages/2326/contents
tags:
- tag: "article:errors"
- tag: "component:ucp"
- tag: "product:datacenter"
- tag: "stage:reviewed"
- tag: "testedon:ucp-2.2.0"
---
{% raw %}
<a href="/troubleshoot/universal-control-plane/" class="button outline-btn">Back to: Universal Control Plane</a><a href="/troubleshoot/docker-datacenter/" class="button outline-btn">Back to: Docker Datacenter</a><p>
 When deploying stacks or services to the ucp-hrm network, an issue may occur where no container is created under the service.
 <code>
  docker service ls
 </code>
 will show fewer tasks scheduled than expected, and tasks scheduled under the service will show
 <code>
  State: "new"
 </code>
 with
 <code>
  Message: "created"
 </code>
 .
</p>
<p>
 The cause of this issue is IP address exhaustion on the ucp-hrm network. To confirm this root cause, watch the Docker daemon logs on the swarm leader for the following error while deploying a service:
</p>
<pre>
<code>dockerd[1148]: time="2017-08-18T16:52:57.658494321Z" level=error msg="Failed allocation for service22vv3642wp8txhbu4t6uk2agx" error="could not find an available IP while allocating VIP" module=node node.id=pujf6ei</code>
</pre>
<div class="mt-section" id="section_1" mt-section-origin="KBase/Containers_will_not_start_on_ucp-hrm_network">
 <span id="Resolution">
 </span>
 <h2 id="1-0">
  Resolution
 </h2>
 <blockquote>
  <p>
   Note: the following procedure requires removing services attached to the ucp-hrm network in order to recreate the network.  This will involve application downtime and requires the ability to re-deploy stacks and services running on that network.
  </p>
 </blockquote>
 <p>
  The default subnet size for ucp-hrm is
  <code>
   /24
  </code>
  (~250 IP addresses).  The resolution involves reconfiguring the network with a larger subnet to allow for more services and replicas to be attached.  Perform the following steps through a UCP client bundle.
 </p>
 <ol style="list-style-type: decimal">
  <li>
   <p>
    Remove all services on the
    <code>
     ucp-hrm
    </code>
    network:
   </p>
   <pre>
<code>HRM_NETWORK_ID=$(docker network ls --no-trunc -qf name=ucp-hrm);
docker service ls -q | \
      xargs docker service inspect --format '{{ range .Spec.TaskTemplate.Networks }}{{ if eq '\"$HRM_NETWORK_ID\"' .Target }}{{ $.Spec.Name }} {{ end }}{{ end }}'  |\
  xargs docker service rm;</code></pre>
  </li>
  <li>
   <p>
    Remove the
    <code>
     ucp-hrm
    </code>
    network:
   </p>
   <pre>
<code>docker network rm ucp-hrm;</code></pre>
  </li>
  <li>
   <p>
    Re-create the ucp-hrm network with a larger subnet size (
    <code>
     /21
    </code>
    will allow for 2046 addresses):
   </p>
   <pre>
<code>docker network create -d overlay  --subnet=10.1.0.0/16 --gateway 10.1.0.1 --label com.docker.ucp.mesh.http=true ucp-hrm</code></pre>
  </li>
  <li>
   <p>
    <a class="link-https" href="/datacenter/ucp/2.2/guides/admin/configure/use-domain-names-to-access-services/#enable-the-http-routing-mesh" rel="external nofollow" target="_blank" title="https://docs.docker.com/datacenter/ucp/2.2/guides/admin/configure/use-domain-names-to-access-services/#enable-the-http-routing-mesh">
     Re-enable ucp-hrm in the UCP Admin UI
    </a>
    .
   </p>
  </li>
  <li>
   <p>
    Re-deploy services removed in step 1.
   </p>
  </li>
 </ol>
</div>
{% endraw %}
