---
title: "Revert UCP certificates to self-signed certificates generated by UCP"
id: 2320
draftstate: inactive
deleted: false
layout: docs
permalink: /kb/2320/
originalpath: https://success.docker.com/KBase/Revert_UCP_certificates_to_self-signed_certificates_generated_by_UCP
source: https://success.docker.com/@api/deki/pages/2320/contents
tags:
- tag: "article:howto"
- tag: "component:ucp"
- tag: "platform:linux"
- tag: "product:datacenter"
- tag: "stage:reviewed"
- tag: "testedon:ucp-2.2.0"
---
{% raw %}
<p>
 For an existing UCP instance, it is possible to
 <strong>
  reconfigure
 </strong>
 UCP to use self-signed certificated generated by UCP.
 <br/>
 <br/>
 This can be helpful in following example instances:
</p>
<ul>
 <li>
  If you used 3rd party certificates and want to revert back to the built-in UCP self-signed certificates.
 </li>
 <li>
  Can not access UCP UI due to expired certificates.
 </li>
</ul>
<div class="mt-section" id="section_1" mt-section-origin="KBase/Revert_UCP_certificates_to_self-signed_certificates_generated_by_UCP">
 <span id="Resolution">
 </span>
 <h2 id="1-0">
  Resolution
 </h2>
 <blockquote>
  <p>
   <strong>
    Note
   </strong>
   : UCP client bundles will need to be re-issued after performing this procedure.
  </p>
 </blockquote>
 <p>
  To revert to self-signed certificates for UCP, ssh into each UCP manager node and perform the following:
 </p>
 <ol>
  <li>
   Remove the contents of the
   <code>
    ucp-controller-server-certs
   </code>
   volume on all managers:
   <pre>
sudo rm $(docker inspect ucp-controller-server-certs --format '{{.Mountpoint}}')/*</pre>
  </li>
  <li>
   Remove the
   <code>
    ucp-proxy
   </code>
   container on one manager:
   <pre>
docker rm -f ucp-proxy</pre>
   <p>
    Reconciliation will begin and regenerate self-signed certificates. Run the following command to watch this processÂ on the same manager:
   </p>
   <pre>
docker logs -f $(docker ps -qf name=ucp-agent)
</pre>
  </li>
  <li>
   Reconfigure DTR to trust the new UCP certificates (be sure to change the DTR image version and UCP URL to match your environment):
   <pre>
 docker run --rm -it docker/dtr:<span class="replaceabletext">2.3.0</span> reconfigure --ucp-insecure-tls --ucp-url https://<span class="replaceabletext">ucp.example.com</span> --ucp-username admin</pre>
  </li>
 </ol>
 <blockquote>
  To revert to self-signed certificates for DTR, refer to
  <a href="/kb/2250/" rel="internal" title="Revert DTR certificates to self-signed certificates generated by DTR">
   Revert DTR certificates to self-signed certificates generated by DTR
  </a>
  .
 </blockquote>
</div>
{% endraw %}
<a href="/troubleshoot/universal-control-plane/" class="button outline-btn">Continue troubleshooting Universal Control Plane</a><br><a href="/troubleshoot/docker-datacenter/" class="button outline-btn">Continue troubleshooting Docker Datacenter</a><br>